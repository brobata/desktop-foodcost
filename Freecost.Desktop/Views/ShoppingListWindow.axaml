<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Freecost.Desktop.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="640"
        x:Class="Freecost.Desktop.Views.ShoppingListWindow"
        x:DataType="vm:ShoppingListViewModel"
        Title="Shopping List"
        Width="800"
        Height="640"
        WindowStartupLocation="CenterOwner"
        Icon="/Assets/icon.ico">

	<Grid RowDefinitions="Auto,Auto,*,Auto" Margin="24">

		<!-- Header -->
		<StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,24">
			<TextBlock Text="ðŸ›’ Shopping List"
			          FontSize="28"
			          FontWeight="Bold"
			          Foreground="#2D2D2D"/>
			<TextBlock Text="{Binding RecipeNames, StringFormat='Recipes: {0}'}"
			          FontSize="14"
			          Foreground="#666"
			          TextWrapping="Wrap"/>
		</StackPanel>

		<!-- Loading Overlay -->
		<Border Grid.Row="1" Grid.RowSpan="3"
		        IsVisible="{Binding IsLoading}"
		        Background="#F0FFFFFF"
		        ZIndex="100">
			<StackPanel VerticalAlignment="Center"
			           HorizontalAlignment="Center"
			           Spacing="16">
				<TextBlock Text="â³"
				          FontSize="48"
				          HorizontalAlignment="Center"/>
				<TextBlock Text="Generating shopping list..."
				          FontSize="16"
				          HorizontalAlignment="Center"
				          Foreground="#666"/>
			</StackPanel>
		</Border>

		<!-- Summary Cards -->
		<Grid Grid.Row="1" ColumnDefinitions="*,*" ColumnSpacing="16" Margin="0,0,0,16">
			<Border Grid.Column="0"
			        Background="#E3F2FD"
			        CornerRadius="8"
			        Padding="16">
				<StackPanel Spacing="4">
					<TextBlock Text="Total Items"
					          FontSize="12"
					          Foreground="#666"/>
					<TextBlock Text="{Binding TotalItems}"
					          FontSize="28"
					          FontWeight="Bold"
					          Foreground="#2196F3"/>
				</StackPanel>
			</Border>

			<Border Grid.Column="1"
			        Background="#E8F5E9"
			        CornerRadius="8"
			        Padding="16">
				<StackPanel Spacing="4">
					<TextBlock Text="Estimated Cost"
					          FontSize="12"
					          Foreground="#666"/>
					<TextBlock Text="{Binding TotalCost, StringFormat='{}{0:C2}'}"
					          FontSize="28"
					          FontWeight="Bold"
					          Foreground="#4CAF50"/>
				</StackPanel>
			</Border>
		</Grid>

		<!-- Shopping List Items -->
		<Border Grid.Row="2"
		        Background="White"
		        CornerRadius="8"
		        BoxShadow="0 2 8 0 #10000000"
		        Padding="16">
			<ScrollViewer>
				<ItemsControl ItemsSource="{Binding ShoppingListItems}">
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Border BorderBrush="#E0E0E0"
							        BorderThickness="0,0,0,1"
							        Padding="12,16">
								<Grid ColumnDefinitions="Auto,2*,*,*,*,Auto">
									<!-- Checkbox -->
									<CheckBox Grid.Column="0"
									         IsChecked="{Binding IsChecked}"
									         VerticalAlignment="Center"
									         Margin="0,0,16,0"/>

									<!-- Ingredient Name & Category -->
									<StackPanel Grid.Column="1" Spacing="4" VerticalAlignment="Center">
										<TextBlock Text="{Binding IngredientName}"
										          FontSize="14"
										          FontWeight="SemiBold"
										          Foreground="#2D2D2D"/>
										<StackPanel Orientation="Horizontal" Spacing="8">
											<Border Background="#E0E0E0"
											        CornerRadius="3"
											        Padding="4,2">
												<TextBlock Text="{Binding Category}"
												          FontSize="10"
												          Foreground="#666"/>
											</Border>
											<TextBlock Text="{Binding RecipeNamesDisplay, StringFormat='Used in: {0}'}"
											          FontSize="10"
											          Foreground="#999"/>
										</StackPanel>
									</StackPanel>

									<!-- Quantity -->
									<TextBlock Grid.Column="2"
									          Text="{Binding Quantity, StringFormat='{}{0:F2}'}"
									          FontSize="14"
									          Foreground="#2D2D2D"
									          VerticalAlignment="Center"
									          HorizontalAlignment="Center"/>

									<!-- Unit -->
									<TextBlock Grid.Column="3"
									          Text="{Binding Unit}"
									          FontSize="14"
									          Foreground="#666"
									          VerticalAlignment="Center"
									          HorizontalAlignment="Center"/>

									<!-- Vendor -->
									<TextBlock Grid.Column="4"
									          Text="{Binding VendorName}"
									          FontSize="12"
									          Foreground="#666"
									          VerticalAlignment="Center"
									          HorizontalAlignment="Center"/>

									<!-- Cost -->
									<StackPanel Grid.Column="5"
									           Spacing="2"
									           HorizontalAlignment="Right"
									           VerticalAlignment="Center">
										<TextBlock Text="{Binding TotalCost, StringFormat='{}{0:C2}'}"
										          FontSize="16"
										          FontWeight="Bold"
										          Foreground="#4CAF50"
										          HorizontalAlignment="Right"/>
										<TextBlock Text="{Binding UnitCost, StringFormat='@ {0:C2}/unit'}"
										          FontSize="10"
										          Foreground="#999"
										          HorizontalAlignment="Right"/>
									</StackPanel>
								</Grid>
							</Border>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>
			</ScrollViewer>
		</Border>

		<!-- Action Buttons -->
		<StackPanel Grid.Row="3"
		           Orientation="Horizontal"
		           Spacing="12"
		           HorizontalAlignment="Right"
		           Margin="0,16,0,0">
			<Button Content="ðŸ“„ Print List"
			        Command="{Binding PrintShoppingListCommand}"
			        Background="#90CAF9"
			        Foreground="White"
			        Padding="16,10"
			        CornerRadius="4"
			        FontWeight="SemiBold"/>
			<Button Content="Close"
			        Command="{Binding CloseCommand}"
			        Background="#E0E0E0"
			        Foreground="#2D2D2D"
			        Padding="16,10"
			        CornerRadius="4"
			        FontWeight="SemiBold"/>
		</StackPanel>
	</Grid>
</Window>
