<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Freecost.Desktop.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="700"
             x:Class="Freecost.Desktop.Views.MenuPlanView"
             x:DataType="vm:MenuPlanViewModel">

	<Grid RowDefinitions="Auto,Auto,*">

		<!-- Header -->
		<StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,16">
			<TextBlock Text="ðŸ“… Menu Planning"
			          FontSize="28"
			          FontWeight="Bold"
			          Foreground="#2D2D2D"/>
			<TextBlock Text="Plan menus for upcoming events and track costs"
			          FontSize="14"
			          Foreground="#666"/>
		</StackPanel>

		<!-- Summary Cards -->
		<Grid Grid.Row="1" ColumnDefinitions="*,*,*" ColumnSpacing="16" Margin="0,0,0,16">
			<Border Grid.Column="0"
			        Background="White"
			        CornerRadius="8"
			        Padding="16"
			        BoxShadow="0 2 8 0 #10000000">
				<StackPanel Spacing="4">
					<TextBlock Text="Total Plans"
					          FontSize="12"
					          Foreground="#999"/>
					<TextBlock Text="{Binding TotalPlans}"
					          FontSize="24"
					          FontWeight="Bold"
					          Foreground="#2196F3"/>
				</StackPanel>
			</Border>

			<Border Grid.Column="1"
			        Background="White"
			        CornerRadius="8"
			        Padding="16"
			        BoxShadow="0 2 8 0 #10000000">
				<StackPanel Spacing="4">
					<TextBlock Text="Total Cost (Period)"
					          FontSize="12"
					          Foreground="#999"/>
					<TextBlock Text="{Binding TotalMonthCost, StringFormat='{}{0:C2}'}"
					          FontSize="24"
					          FontWeight="Bold"
					          Foreground="#4CAF50"/>
				</StackPanel>
			</Border>

			<Border Grid.Column="2"
			        Background="White"
			        CornerRadius="8"
			        Padding="16"
			        BoxShadow="0 2 8 0 #10000000">
				<StackPanel Spacing="8">
					<TextBlock Text="Quick Actions"
					          FontSize="12"
					          Foreground="#999"/>
					<Button Content="âž• Add Menu Plan"
					        Command="{Binding AddMenuPlanCommand}"
					        Background="#A5D6A7"
					        Foreground="White"
					        Padding="12,6"
					        CornerRadius="4"
					        FontWeight="SemiBold"
					        HorizontalAlignment="Stretch"/>
				</StackPanel>
			</Border>
		</Grid>

		<!-- Main Content -->
		<Grid Grid.Row="2" ColumnDefinitions="3*,2*" ColumnSpacing="16">

			<!-- Left: Menu Plans List -->
			<Border Grid.Column="0"
			        Background="White"
			        CornerRadius="8"
			        Padding="16"
			        BoxShadow="0 2 8 0 #10000000">
				<Grid RowDefinitions="Auto,*">
					<TextBlock Grid.Row="0"
					          Text="Menu Plans"
					          FontSize="18"
					          FontWeight="Bold"
					          Foreground="#2D2D2D"
					          Margin="0,0,0,16"/>

					<ScrollViewer Grid.Row="1">
						<ItemsControl ItemsSource="{Binding MenuPlans}">
							<ItemsControl.ItemTemplate>
								<DataTemplate>
									<Border Background="#FAFAFA"
									        BorderBrush="#E0E0E0"
									        BorderThickness="0,0,0,1"
									        Padding="12"
									        Margin="0,0,0,8">
										<Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto,Auto">
											<!-- Date & Name -->
											<StackPanel Grid.Column="0" Grid.Row="0" Spacing="4">
												<TextBlock Text="{Binding DateDisplay}"
												          FontSize="14"
												          FontWeight="Bold"
												          Foreground="#2D2D2D"/>
												<TextBlock Text="{Binding Name}"
												          FontSize="12"
												          Foreground="#666"/>
											</StackPanel>

											<!-- Delete Button -->
											<Button Grid.Column="1" Grid.Row="0"
											        Content="ðŸ—‘ï¸"
											        Command="{Binding $parent[ItemsControl].((vm:MenuPlanViewModel)DataContext).DeleteMenuPlanCommand}"
											        CommandParameter="{Binding}"
											        Background="Transparent"
											        BorderThickness="0"
											        Padding="8"
											        ToolTip.Tip="Delete menu plan"/>

											<!-- Event Info -->
											<Grid Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="1"
											      ColumnDefinitions="Auto,*" ColumnSpacing="16" Margin="0,8,0,0">
												<StackPanel Grid.Column="0" Spacing="2">
													<TextBlock Text="Event Type"
													          FontSize="10"
													          Foreground="#999"/>
													<TextBlock Text="{Binding EventType}"
													          FontSize="12"
													          Foreground="#2D2D2D"/>
												</StackPanel>

												<StackPanel Grid.Column="1" Spacing="2">
													<TextBlock Text="Expected Guests"
													          FontSize="10"
													          Foreground="#999"/>
													<TextBlock Text="{Binding ExpectedGuests}"
													          FontSize="12"
													          Foreground="#2D2D2D"/>
												</StackPanel>
											</Grid>

											<!-- Entrees List -->
											<Border Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="2"
											        Background="#F5F5F5"
											        CornerRadius="4"
											        Padding="8"
											        Margin="0,8,0,0">
												<StackPanel Spacing="4">
													<TextBlock Text="Entrees:"
													          FontSize="11"
													          FontWeight="SemiBold"
													          Foreground="#666"/>
													<ItemsControl ItemsSource="{Binding Entrees}">
														<ItemsControl.ItemTemplate>
															<DataTemplate>
																<Grid ColumnDefinitions="*,Auto,Auto">
																	<TextBlock Grid.Column="0"
																	          Text="{Binding EntreeName}"
																	          FontSize="11"
																	          Foreground="#2D2D2D"/>
																	<TextBlock Grid.Column="1"
																	          Text="{Binding Quantity, StringFormat='x{0}'}"
																	          FontSize="11"
																	          Foreground="#666"
																	          Margin="0,0,8,0"/>
																	<Button Grid.Column="2"
																	        Content="âœ•"
																	        Command="{Binding $parent[ItemsControl].((vm:MenuPlanViewModel)DataContext).RemoveEntreeFromMenuCommand}"
																	        CommandParameter="{Binding}"
																	        Background="Transparent"
																	        BorderThickness="0"
																	        Padding="4"
																	        FontSize="10"/>
																</Grid>
															</DataTemplate>
														</ItemsControl.ItemTemplate>
													</ItemsControl>
													<TextBlock IsVisible="{Binding !Entrees.Count}"
													          Text="No entrees added"
													          FontSize="11"
													          FontStyle="Italic"
													          Foreground="#999"/>
												</StackPanel>
											</Border>

											<!-- Cost Summary -->
											<Grid Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="3"
											      ColumnDefinitions="*,*"
											      Margin="0,8,0,0">
												<StackPanel Grid.Column="0" Spacing="2">
													<TextBlock Text="Total Cost"
													          FontSize="10"
													          Foreground="#999"/>
													<TextBlock Text="{Binding TotalCost, StringFormat='{}{0:C2}'}"
													          FontSize="14"
													          FontWeight="Bold"
													          Foreground="#4CAF50"/>
												</StackPanel>

												<StackPanel Grid.Column="1" Spacing="2" HorizontalAlignment="Right">
													<TextBlock Text="Cost per Guest"
													          FontSize="10"
													          Foreground="#999"
													          HorizontalAlignment="Right"/>
													<TextBlock Text="{Binding CostPerGuest, StringFormat='{}{0:C2}'}"
													          FontSize="14"
													          FontWeight="Bold"
													          Foreground="#2196F3"
													          HorizontalAlignment="Right"/>
												</StackPanel>
											</Grid>

											<!-- Select Button -->
											<Button Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="4"
											        Content="Select"
											        Background="#90CAF9"
											        Foreground="White"
											        Padding="12,6"
											        CornerRadius="4"
											        FontSize="12"
											        HorizontalAlignment="Stretch"
											        Margin="0,12,0,0"
											        Click="OnMenuPlanSelected"
											        Tag="{Binding}"/>
										</Grid>
									</Border>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</ScrollViewer>
				</Grid>
			</Border>

			<!-- Right: Available Entrees -->
			<Border Grid.Column="1"
			        Background="White"
			        CornerRadius="8"
			        Padding="16"
			        BoxShadow="0 2 8 0 #10000000">
				<Grid RowDefinitions="Auto,*">
					<TextBlock Grid.Row="0"
					          Text="Available Entrees"
					          FontSize="18"
					          FontWeight="Bold"
					          Foreground="#2D2D2D"
					          Margin="0,0,0,16"/>

					<ScrollViewer Grid.Row="1">
						<ItemsControl ItemsSource="{Binding AvailableEntrees}">
							<ItemsControl.ItemTemplate>
								<DataTemplate>
									<Border BorderBrush="#E0E0E0"
									        BorderThickness="0,0,0,1"
									        Padding="12"
									        Margin="0,0,0,4">
										<Grid ColumnDefinitions="*,Auto">
											<StackPanel Grid.Column="0" Spacing="4">
												<TextBlock Text="{Binding Name}"
												          FontSize="14"
												          FontWeight="SemiBold"
												          Foreground="#2D2D2D"/>
												<StackPanel Orientation="Horizontal" Spacing="8">
													<Border Background="#E0E0E0"
													        CornerRadius="3"
													        Padding="4,2">
														<TextBlock Text="{Binding Category}"
														          FontSize="10"
														          Foreground="#666"/>
													</Border>
													<TextBlock Text="{Binding Cost, StringFormat='{}{0:C2}'}"
													          FontSize="12"
													          FontWeight="Bold"
													          Foreground="#4CAF50"/>
												</StackPanel>
											</StackPanel>

											<Button Grid.Column="1"
											        Content="âž•"
											        Command="{Binding $parent[ItemsControl].((vm:MenuPlanViewModel)DataContext).AddEntreeToMenuCommand}"
											        CommandParameter="{Binding}"
											        Background="#A5D6A7"
											        Foreground="White"
											        Padding="12,6"
											        CornerRadius="4"
											        FontSize="16"
											        ToolTip.Tip="Add to selected menu"/>
										</Grid>
									</Border>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</ScrollViewer>
				</Grid>
			</Border>
		</Grid>
	</Grid>
</UserControl>
