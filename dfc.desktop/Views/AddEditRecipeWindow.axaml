<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Dfc.Desktop.ViewModels"
        xmlns:controls="using:Dfc.Desktop.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="750" d:DesignHeight="640"
        x:Class="Dfc.Desktop.Views.AddEditRecipeWindow"
        x:DataType="vm:AddEditRecipeViewModel"
        Title="{Binding DialogTitle}"
        Width="750" Height="640"
        MinWidth="600" MinHeight="500"
        MaxWidth="1200" MaxHeight="900"
        WindowStartupLocation="CenterOwner"
        CanResize="True"
        Background="White">

	<Window.Styles>
		<Style Selector="TabItem">
			<Setter Property="Foreground" Value="#2D2D2D"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
		</Style>
		<Style Selector="TabItem:pointerover">
			<Setter Property="Foreground" Value="#7AB51D"/>
		</Style>
		<Style Selector="TabItem:selected">
			<Setter Property="Foreground" Value="#7AB51D"/>
		</Style>
	</Window.Styles>

	<Grid RowDefinitions="*,Auto" Margin="24">

		<!-- Tab Content -->
		<TabControl Grid.Row="0">

			<!-- TAB 1: RECIPE INFO -->
			<TabItem Header="Recipe Info">
				<ScrollViewer VerticalScrollBarVisibility="Auto">
					<StackPanel Spacing="18" Margin="0,16,0,0">

						<!-- Validation Panel -->
						<controls:ValidationPanel ValidationResult="{Binding ValidationResult}"/>

						<!-- PHOTO UPLOAD -->
						<controls:PhotoUploadControl PhotoUrl="{Binding PhotoUrl}"
						                            PhotoService="{Binding PhotoService}"
						                            PhotoChanged="OnPhotoChanged"/>

						<!-- Recipe Name -->
						<StackPanel Spacing="7">
							<TextBlock Text="Recipe Name *" FontWeight="SemiBold" FontSize="14" Foreground="#2D2D2D"/>
							<TextBox x:Name="NameTextBox" Text="{Binding Name}" Watermark="Enter recipe name..." Padding="12,10" FontSize="14" TabIndex="0"/>
						</StackPanel>

						<!-- Description -->
						<StackPanel Spacing="7">
							<TextBlock Text="Description" FontWeight="SemiBold" FontSize="14" Foreground="#2D2D2D"/>
							<TextBox Text="{Binding Description}" Watermark="Brief description of the recipe..." Padding="12,10" FontSize="14" TabIndex="1"/>
						</StackPanel>

						<!-- Yield Row -->
						<Grid ColumnDefinitions="*,140" ColumnSpacing="16">
							<StackPanel Grid.Column="0" Spacing="7">
								<TextBlock Text="Yield Amount *" FontWeight="SemiBold" FontSize="14" Foreground="#2D2D2D"/>
								<TextBox Text="{Binding YieldAmount}" Watermark="32" Padding="12,10" FontSize="14" TabIndex="2"/>
							</StackPanel>

							<StackPanel Grid.Column="1" Spacing="7">
								<TextBlock Text="Unit *" FontWeight="SemiBold" FontSize="14" Foreground="#2D2D2D"/>
								<ComboBox SelectedItem="{Binding YieldUnit}" ItemsSource="{Binding AvailableUnits}" Padding="12,10" FontSize="14" TabIndex="3"/>
							</StackPanel>
						</Grid>

						<!-- COMPONENTS SECTION (Ingredients + Recipes) -->
						<StackPanel Spacing="12">
							<Grid ColumnDefinitions="*,Auto,Auto,Auto" ColumnSpacing="12">
								<TextBlock Grid.Column="0" Text="Components" FontWeight="Bold" FontSize="16" Foreground="#2D2D2D" VerticalAlignment="Center"/>
								<TextBlock Grid.Column="1" Text="{Binding FoodCostDisplay}" FontWeight="SemiBold" FontSize="14" Foreground="#7AB51D" VerticalAlignment="Center"/>
								<Button Grid.Column="2" Content="âž• Add Recipe" Command="{Binding AddRecipeCommand}" Background="#2196F3" Foreground="White" Padding="12,8" CornerRadius="4" FontSize="13" FontWeight="SemiBold" ToolTip.Tip="Add a sub-recipe as a component"/>
								<Button Grid.Column="3" Content="âž• Add Ingredient" Command="{Binding AddIngredientCommand}" Background="#7AB51D" Foreground="White" Padding="12,8" CornerRadius="4" FontSize="13" FontWeight="SemiBold" ToolTip.Tip="Add an ingredient to this recipe"/>
							</Grid>

							<Border BorderBrush="#D0D0D0" BorderThickness="1" CornerRadius="6" Background="White" MinHeight="120">
								<ItemsControl ItemsSource="{Binding Components}">
									<ItemsControl.ItemTemplate>
										<DataTemplate>
											<Border BorderBrush="#E5E5E5" BorderThickness="0,0,0,1" Padding="12,10" Background="{Binding IsPlaceholder, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#FFF3E0|Transparent'}">
												<Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto,Auto" ColumnSpacing="8">
													<!-- Warning icon for placeholders/unmatched -->
													<TextBlock Grid.Column="0"
															  Text="âš ï¸"
															  FontSize="14"
															  VerticalAlignment="Center"
															  IsVisible="{Binding IsPlaceholder}"
															  ToolTip.Tip="This component is not matched. Link it to the correct item."/>
													<TextBlock Grid.Column="1"
															  Text="{Binding Name}"
															  FontWeight="SemiBold"
															  FontSize="13"
															  VerticalAlignment="Center"
															  Foreground="{Binding IsPlaceholder, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E65100|#2D2D2D'}"/>
													<TextBlock Grid.Column="2"
															  Text="{Binding QuantityDisplay}"
															  FontSize="13"
															  Foreground="#666"
															  Margin="0,0,12,0"
															  VerticalAlignment="Center"/>
													<TextBlock Grid.Column="3"
															  Text="{Binding Cost, StringFormat='{}{0:C2}'}"
															  FontSize="13"
															  Foreground="{Binding IsPlaceholder, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E65100|#7AB51D'}"
															  FontWeight="SemiBold"
															  Margin="0,0,12,0"
															  VerticalAlignment="Center"/>
													<!-- Mapping Chain Icon (visible when component has saved mapping) -->
													<Button Grid.Column="4"
														   Content="ðŸ”—"
														   Command="{Binding $parent[ItemsControl].((vm:AddEditRecipeViewModel)DataContext).ViewMappingCommand}"
														   CommandParameter="{Binding}"
														   Background="#4CAF50"
														   Foreground="White"
														   BorderThickness="0"
														   Padding="8,4"
														   FontSize="14"
																   CornerRadius="3"
																   IsVisible="{Binding HasMapping}"
																   ToolTip.Tip="This ingredient has a saved mapping. Click to view or edit.">
																<Button.Styles>
																	<Style Selector="Button:pointerover">
																		<Setter Property="Background" Value="#45A049"/>
																	</Style>
																</Button.Styles>
															</Button>
															<Button Grid.Column="5"
																   Content="ðŸ—‘ï¸"
																   Command="{Binding $parent[ItemsControl].((vm:AddEditRecipeViewModel)DataContext).RemoveComponentCommand}"
																   CommandParameter="{Binding}"
																   Background="Transparent"
																   BorderThickness="0"
																   Padding="8,4"
																   FontSize="14"
																   ToolTip.Tip="Remove this ingredient">
																<Button.Styles>
																	<Style Selector="Button:pointerover">
																		<Setter Property="Background" Value="#FFEBEE"/>
																	</Style>
																</Button.Styles>
															</Button>
														</Grid>
												</Border>
											</DataTemplate>
										</ItemsControl.ItemTemplate>
									</ItemsControl>
							</Border>

							<StackPanel IsVisible="{Binding Components.Count, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=0}" Spacing="8" HorizontalAlignment="Center" Margin="0,20">
								<TextBlock Text="No ingredients added yet" FontSize="14" Foreground="#999" HorizontalAlignment="Center"/>
								<TextBlock Text="Click 'Add Ingredient' to get started" FontSize="12" Foreground="#BBB" HorizontalAlignment="Center"/>
							</StackPanel>
						</StackPanel>

						<!-- Instructions Steps -->
						<StackPanel Spacing="12">
							<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
								<TextBlock Grid.Column="0" Text="Instructions" FontWeight="Bold" FontSize="16" VerticalAlignment="Center"/>
								<Button Grid.Column="1" Content="âž• Add Step" Command="{Binding AddInstructionStepCommand}" Background="#2196F3" Foreground="White" Padding="12,8" CornerRadius="4" FontSize="13" FontWeight="SemiBold"/>
							</Grid>

							<Border BorderBrush="#D0D0D0" BorderThickness="1" CornerRadius="6" MinHeight="100">
								<ItemsControl ItemsSource="{Binding InstructionSteps}">
									<ItemsControl.ItemTemplate>
										<DataTemplate>
											<Border BorderBrush="#E5E5E5" BorderThickness="0,0,0,1" Padding="12,10">
												<Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
													<TextBlock Grid.Column="0"
													           Text="{Binding StepNumber}"
													           FontWeight="Bold"
													           FontSize="14"
													           Foreground="#7AB51D"
													           VerticalAlignment="Top"
													           Margin="0,8,0,0"/>

													<!-- Dual-mode: TextBlock for display, TextBox for editing -->
													<Panel Grid.Column="1">
														<!-- Display Mode: TextBlock (auto-expanding, wraps perfectly) -->
														<Border Background="Transparent"
														        Padding="10,8"
														        CornerRadius="4"
														        IsVisible="{Binding !IsEditing}"
														        Cursor="Hand">
															<Border.Styles>
																<Style Selector="Border:pointerover">
																	<Setter Property="Background" Value="#F5F5F5"/>
																</Style>
															</Border.Styles>
															<TextBlock Text="{Binding Description}"
															           TextWrapping="Wrap"
															           FontSize="14"
															           Foreground="#2D2D2D"
															           VerticalAlignment="Center"
															           Tapped="OnStepTextTapped">
																<TextBlock.Styles>
																	<Style Selector="TextBlock">
																		<Setter Property="Foreground" Value="#2D2D2D"/>
																	</Style>
																	<Style Selector="TextBlock:pointerover">
																		<Setter Property="Foreground" Value="#7AB51D"/>
																	</Style>
																</TextBlock.Styles>
															</TextBlock>
														</Border>

														<!-- Edit Mode: TextBox (shown when IsEditing=true) -->
														<TextBox Text="{Binding Description}"
														         Watermark="Enter instruction step..."
														         TextWrapping="Wrap"
														         AcceptsReturn="True"
														         MinHeight="40"
														         MaxHeight="200"
														         Padding="10,8"
														         FontSize="14"
														         VerticalAlignment="Stretch"
														         IsVisible="{Binding IsEditing}"
														         LostFocus="OnStepTextBoxLostFocus"
														         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
														         ScrollViewer.VerticalScrollBarVisibility="Auto"/>
													</Panel>

													<Button Grid.Column="2"
													        Content="ðŸ—‘ï¸"
													        Command="{Binding $parent[Window].DataContext.RemoveInstructionStepCommand}"
													        CommandParameter="{Binding}"
													        Background="Transparent"
													        BorderThickness="0"
													        VerticalAlignment="Top"
													        Margin="0,4,0,0"
													        ToolTip.Tip="Remove step">
														<Button.Styles>
															<Style Selector="Button:pointerover">
																<Setter Property="Background" Value="#FFEBEE"/>
															</Style>
														</Button.Styles>
													</Button>
												</Grid>
											</Border>
										</DataTemplate>
									</ItemsControl.ItemTemplate>
								</ItemsControl>
							</Border>
						</StackPanel>

						<!-- RECIPE SCALING -->
						<Border Background="#E3F2FD" CornerRadius="6" Padding="14,12">
							<StackPanel Spacing="10">
								<Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
									<TextBlock Grid.Column="0" Text="Scale Recipe:" FontWeight="SemiBold" FontSize="13" Foreground="#1976D2" VerticalAlignment="Center"/>
									<TextBox Grid.Column="1" Text="{Binding ScaleMultiplier}" Watermark="1.0" Padding="10,8" FontSize="13" MaxWidth="100" HorizontalAlignment="Left" ToolTip.Tip="Enter multiplier (e.g., 2 for double, 0.5 for half)"/>
									<Button Grid.Column="2" Content="âš–ï¸ Scale" Command="{Binding ScaleRecipeCommand}" Background="#2196F3" Foreground="White" Padding="14,8" CornerRadius="4" FontSize="13" FontWeight="SemiBold" ToolTip.Tip="Scale all ingredient quantities and yield"/>
								</Grid>
								<WrapPanel Orientation="Horizontal" HorizontalAlignment="Left">
									<TextBlock Text="Quick Scale:" FontSize="12" Foreground="#1976D2" VerticalAlignment="Center" Margin="0,0,8,0"/>
									<Button Content="Half (0.5x)" Command="{Binding ScaleRecipeByPresetCommand}" CommandParameter="0.5" Padding="8,4" Margin="0,0,4,0" FontSize="11" Background="#42A5F5" Foreground="White" CornerRadius="3" ToolTip.Tip="Scale to half size"/>
									<Button Content="Double (2x)" Command="{Binding ScaleRecipeByPresetCommand}" CommandParameter="2" Padding="8,4" Margin="0,0,4,0" FontSize="11" Background="#42A5F5" Foreground="White" CornerRadius="3" ToolTip.Tip="Scale to double size"/>
									<Button Content="Triple (3x)" Command="{Binding ScaleRecipeByPresetCommand}" CommandParameter="3" Padding="8,4" Margin="0,0,4,0" FontSize="11" Background="#42A5F5" Foreground="White" CornerRadius="3" ToolTip.Tip="Scale to triple size"/>
									<Button Content="4x Batch" Command="{Binding ScaleRecipeByPresetCommand}" CommandParameter="4" Padding="8,4" Margin="0,0,4,0" FontSize="11" Background="#42A5F5" Foreground="White" CornerRadius="3" ToolTip.Tip="Scale to 4x batch"/>
									<Button Content="10x Batch" Command="{Binding ScaleRecipeByPresetCommand}" CommandParameter="10" Padding="8,4" FontSize="11" Background="#42A5F5" Foreground="White" CornerRadius="3" ToolTip.Tip="Scale to 10x batch"/>
								</WrapPanel>
							</StackPanel>
						</Border>

					</StackPanel>
				</ScrollViewer>
			</TabItem>

			<!-- TAB 2: ALLERGENS -->
			<TabItem Header="Allergens">
				<ScrollViewer VerticalScrollBarVisibility="Auto">
					<StackPanel Spacing="20" Margin="0,16,0,0">
						<Border Background="#FFF9E6" BorderBrush="#FFE082" BorderThickness="1" CornerRadius="6" Padding="16">
							<StackPanel Spacing="8">
								<TextBlock Text="ðŸ’¡ Allergens are automatically detected from ingredients"
								          FontWeight="SemiBold"
								          FontSize="13"
								          Foreground="#F57F17"/>
								<TextBlock Text="Auto-detected allergens will show which ingredients contain them. You can manually check/uncheck any allergen."
								          FontSize="12"
								          Foreground="#666"
								          TextWrapping="Wrap"/>
							</StackPanel>
						</Border>
						<controls:AllergenSelectorControl x:Name="AllergenSelector"/>
					</StackPanel>
				</ScrollViewer>
			</TabItem>

			<!-- TAB 3: NUTRITION & DIETARY -->
			<TabItem Header="Nutrition">
				<ScrollViewer VerticalScrollBarVisibility="Auto">
					<StackPanel Spacing="18" Margin="0,16,0,0">

						<Border Background="#E8F5E9" BorderBrush="#A5D6A7" BorderThickness="1" CornerRadius="6" Padding="16">
							<StackPanel Spacing="8">
								<TextBlock Text="ðŸ¥— Nutritional Information (per serving)"
								          FontWeight="SemiBold"
								          FontSize="13"
								          Foreground="#388E3C"/>
								<TextBlock Text="All values are optional and represent amounts per single serving."
								          FontSize="12"
								          Foreground="#666"
								          TextWrapping="Wrap"/>
							</StackPanel>
						</Border>

						<!-- Calculated Nutrition (Read-only) -->
						<Border Background="#F3E5F5" BorderBrush="#9C27B0" BorderThickness="2" CornerRadius="6" Padding="16">
							<StackPanel Spacing="12">
								<TextBlock Text="ðŸ“Š Calculated Nutrition (from ingredients)" FontWeight="Bold" FontSize="15" Foreground="#6A1B9A"/>
								<TextBlock Text="Nutrition is automatically calculated from the ingredients you add. To edit nutrition, update the ingredient nutrition values."
								          FontSize="12"
								          Foreground="#7B1FA2"
								          FontStyle="Italic"
								          TextWrapping="Wrap"/>

								<!-- Nutrition Grid -->
								<Grid ColumnDefinitions="*,*,*" ColumnSpacing="12" RowDefinitions="Auto,Auto,Auto" RowSpacing="8" Margin="0,8,0,0">

									<!-- Row 1 -->
									<StackPanel Grid.Column="0" Grid.Row="0" Spacing="4">
										<TextBlock Text="Calories" FontWeight="SemiBold" FontSize="13" Foreground="#6A1B9A"/>
										<Border Background="White" BorderBrush="#9C27B0" BorderThickness="1" CornerRadius="4" Padding="8,6">
											<TextBlock Text="{Binding CalculatedCalories}" FontSize="14" FontWeight="SemiBold"/>
										</Border>
									</StackPanel>

									<StackPanel Grid.Column="1" Grid.Row="0" Spacing="4">
										<TextBlock Text="Protein (g)" FontWeight="SemiBold" FontSize="13" Foreground="#6A1B9A"/>
										<Border Background="White" BorderBrush="#9C27B0" BorderThickness="1" CornerRadius="4" Padding="8,6">
											<TextBlock Text="{Binding CalculatedProtein}" FontSize="14" FontWeight="SemiBold"/>
										</Border>
									</StackPanel>

									<StackPanel Grid.Column="2" Grid.Row="0" Spacing="4">
										<TextBlock Text="Fat (g)" FontWeight="SemiBold" FontSize="13" Foreground="#6A1B9A"/>
										<Border Background="White" BorderBrush="#9C27B0" BorderThickness="1" CornerRadius="4" Padding="8,6">
											<TextBlock Text="{Binding CalculatedFat}" FontSize="14" FontWeight="SemiBold"/>
										</Border>
									</StackPanel>

									<!-- Row 2 -->
									<StackPanel Grid.Column="0" Grid.Row="1" Spacing="4">
										<TextBlock Text="Carbs (g)" FontWeight="SemiBold" FontSize="13" Foreground="#6A1B9A"/>
										<Border Background="White" BorderBrush="#9C27B0" BorderThickness="1" CornerRadius="4" Padding="8,6">
											<TextBlock Text="{Binding CalculatedCarbohydrates}" FontSize="14" FontWeight="SemiBold"/>
										</Border>
									</StackPanel>

									<StackPanel Grid.Column="1" Grid.Row="1" Spacing="4">
										<TextBlock Text="Fiber (g)" FontWeight="SemiBold" FontSize="13" Foreground="#6A1B9A"/>
										<Border Background="White" BorderBrush="#9C27B0" BorderThickness="1" CornerRadius="4" Padding="8,6">
											<TextBlock Text="{Binding CalculatedFiber}" FontSize="14" FontWeight="SemiBold"/>
										</Border>
									</StackPanel>

									<StackPanel Grid.Column="2" Grid.Row="1" Spacing="4">
										<TextBlock Text="Sugar (g)" FontWeight="SemiBold" FontSize="13" Foreground="#6A1B9A"/>
										<Border Background="White" BorderBrush="#9C27B0" BorderThickness="1" CornerRadius="4" Padding="8,6">
											<TextBlock Text="{Binding CalculatedSugar}" FontSize="14" FontWeight="SemiBold"/>
										</Border>
									</StackPanel>

									<!-- Row 3 -->
									<StackPanel Grid.Column="0" Grid.Row="2" Spacing="4">
										<TextBlock Text="Sodium (mg)" FontWeight="SemiBold" FontSize="13" Foreground="#6A1B9A"/>
										<Border Background="White" BorderBrush="#9C27B0" BorderThickness="1" CornerRadius="4" Padding="8,6">
											<TextBlock Text="{Binding CalculatedSodium}" FontSize="14" FontWeight="SemiBold"/>
										</Border>
									</StackPanel>

								</Grid>
							</StackPanel>
						</Border>

						<!-- Dietary Labels -->
						<StackPanel Spacing="7">
							<TextBlock Text="Dietary Labels" FontWeight="Bold" FontSize="15" Foreground="#2D2D2D"/>
							<TextBlock Text="Comma-separated dietary classifications (e.g., Vegan, Gluten-Free, Dairy-Free, Keto, Paleo)"
							          FontSize="11"
							          Foreground="#666"
							          TextWrapping="Wrap"/>
							<TextBox Text="{Binding DietaryLabels}" Watermark="Vegan, Gluten-Free, Low-Carb..." Padding="10,8" FontSize="13"/>
						</StackPanel>

					</StackPanel>
				</ScrollViewer>
			</TabItem>

			<!-- TAB 4: ADVANCED -->
			<TabItem Header="Advanced">
				<ScrollViewer VerticalScrollBarVisibility="Auto">
					<StackPanel Spacing="18" Margin="0,16,0,0">

						<!-- Category -->
						<StackPanel Spacing="7">
							<TextBlock Text="Category" FontWeight="SemiBold" FontSize="14" Foreground="#2D2D2D"/>
							<TextBox Text="{Binding Category}" Watermark="e.g., Sauces, Bases, Proteins, Sides..." Padding="12,10" FontSize="14"/>
						</StackPanel>

						<!-- Tags -->
						<StackPanel Spacing="7">
							<TextBlock Text="Tags" FontWeight="SemiBold" FontSize="14" Foreground="#2D2D2D"/>
							<TextBox Text="{Binding Tags}" Watermark="breakfast, quick, vegetarian..." Padding="12,10" FontSize="14"/>
						</StackPanel>

						<!-- Internal Notes -->
						<StackPanel Spacing="7">
							<TextBlock Text="Internal Notes" FontWeight="SemiBold" FontSize="14" Foreground="#2D2D2D" ToolTip.Tip="These notes are for internal use only and will not be printed on recipe cards or reports"/>
							<Border BorderBrush="#D0D0D0" BorderThickness="1" CornerRadius="4" Background="White">
								<TextBox Text="{Binding Notes}" Watermark="Internal notes, tips, or variations (won't be printed)..." Background="Transparent" BorderThickness="0" Padding="12,10" FontSize="14" MinHeight="120" TextWrapping="Wrap" AcceptsReturn="True" VerticalContentAlignment="Top"/>
							</Border>
						</StackPanel>

					</StackPanel>
				</ScrollViewer>
			</TabItem>

		</TabControl>

		<!-- Action Buttons -->
		<Border Grid.Row="1" Margin="0,24,0,0" Padding="0,20,0,0" BorderBrush="#E5E5E5" BorderThickness="0,1,0,0">
			<Grid RowDefinitions="Auto,Auto" RowSpacing="12">
				<!-- Keyboard Shortcuts Hint -->
				<Border Grid.Row="0" Background="#F5F5F5" CornerRadius="4" Padding="10,6">
					<TextBlock FontSize="11" Foreground="#666">
						<Run Text="âŒ¨ï¸ Shortcuts:"/>
						<Run Text="Ctrl+S" FontWeight="SemiBold" Foreground="#7AB51D"/>
						<Run Text="Save â€¢"/>
						<Run Text="Ctrl+N" FontWeight="SemiBold" Foreground="#7AB51D"/>
						<Run Text="Add Ingredient â€¢"/>
						<Run Text="Ctrl+P" FontWeight="SemiBold" Foreground="#7AB51D"/>
						<Run Text="PDF â€¢"/>
						<Run Text="Esc" FontWeight="SemiBold" Foreground="#7AB51D"/>
						<Run Text="Cancel"/>
					</TextBlock>
				</Border>

				<!-- Buttons -->
				<Grid Grid.Row="1" ColumnDefinitions="*,Auto,Auto,Auto,Auto" ColumnSpacing="12">
					<TextBlock Grid.Column="0" Text="* Required fields" VerticalAlignment="Center" Foreground="#666" FontSize="13"/>
					<Button Grid.Column="1" Content="ðŸ“„ Generate PDF" Command="{Binding GeneratePdfCommand}" Padding="20,11" MinWidth="140" IsVisible="{Binding IsEditMode}" Background="#2196F3" Foreground="White" ToolTip.Tip="Generate a printable recipe card PDF (Ctrl+P)"/>
					<Button Grid.Column="2" Content="Cancel" Command="{Binding CancelCommand}" Padding="28,11" MinWidth="110" ToolTip.Tip="Cancel without saving (Esc)"/>
					<Button Grid.Column="3" Content="Save Recipe" Command="{Binding SaveCommand}" Padding="28,11" MinWidth="130" Classes="primary" ToolTip.Tip="Save this recipe (Ctrl+S)"/>
				</Grid>
			</Grid>
		</Border>
	</Grid>
</Window>
