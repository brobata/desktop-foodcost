<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Dfc.Desktop.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="700"
        x:Class="Dfc.Desktop.Views.NotificationsWindow"
        x:DataType="vm:NotificationsViewModel"
        Title="Notifications"
        Width="600"
        Height="700"
        WindowStartupLocation="CenterOwner"
        Icon="/Assets/Images/appicon.png">

	<Grid RowDefinitions="Auto,*,Auto" Margin="24">

		<!-- Header -->
		<StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,24">
			<TextBlock Text="ðŸ”” Notifications"
			          FontSize="24"
			          FontWeight="Bold"
			          Foreground="#2D2D2D"/>
			<Grid ColumnDefinitions="*,Auto">
				<TextBlock Grid.Column="0"
				          Text="{Binding UnreadCount, StringFormat='{}{0} unread'}"
				          FontSize="14"
				          Foreground="#666"/>
				<Button Grid.Column="1"
				        Content="Mark All Read"
				        Command="{Binding MarkAllReadCommand}"
				        Background="Transparent"
				        Foreground="#2196F3"
				        Padding="8,4"
				        FontSize="12"
				        FontWeight="SemiBold"/>
			</Grid>
		</StackPanel>

		<!-- Notifications List -->
		<Border Grid.Row="1"
		        Background="White"
		        CornerRadius="8"
		        Padding="0"
		        BoxShadow="0 2 8 0 #10000000">
			<ScrollViewer>
				<ItemsControl ItemsSource="{Binding Notifications}">
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Border BorderBrush="#EEE"
							        BorderThickness="0,0,0,1"
							        Padding="16,12"
							        Background="{Binding BackgroundColor}">
								<Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
									<!-- Icon/Indicator -->
									<Border Grid.Column="0"
									        Width="8"
									        Height="8"
									        CornerRadius="4"
									        Background="{Binding PriorityColor}"
									        VerticalAlignment="Top"
									        Margin="0,6,0,0"
									        IsVisible="{Binding !IsRead}"/>

									<!-- Content -->
									<StackPanel Grid.Column="1" Spacing="4">
										<TextBlock Text="{Binding Title}"
										          FontWeight="SemiBold"
										          FontSize="13"
										          Foreground="#2D2D2D"
										          TextWrapping="Wrap"/>
										<TextBlock Text="{Binding Message}"
										          FontSize="12"
										          Foreground="#666"
										          TextWrapping="Wrap"/>
										<TextBlock Text="{Binding TimeAgo}"
										          FontSize="11"
										          Foreground="#999"/>
									</StackPanel>

									<!-- Actions -->
									<StackPanel Grid.Column="2" Spacing="4" VerticalAlignment="Top">
										<Button Content="âœ“"
										        Command="{Binding $parent[Window].((vm:NotificationsViewModel)DataContext).MarkAsReadCommand}"
										        CommandParameter="{Binding}"
										        IsVisible="{Binding !IsRead}"
										        Background="Transparent"
										        BorderThickness="0"
										        Padding="6"
										        FontSize="14"
										        ToolTip.Tip="Mark as read"/>
										<Button Content="ðŸ—‘ï¸"
										        Command="{Binding $parent[Window].((vm:NotificationsViewModel)DataContext).DeleteNotificationCommand}"
										        CommandParameter="{Binding}"
										        Background="Transparent"
										        BorderThickness="0"
										        Padding="6"
										        FontSize="12"
										        ToolTip.Tip="Delete"/>
									</StackPanel>
								</Grid>
							</Border>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>
			</ScrollViewer>
		</Border>

		<!-- Footer -->
		<Grid Grid.Row="2" ColumnDefinitions="*,Auto" Margin="0,16,0,0">
			<Button Grid.Column="1"
			        Content="Close"
			        Click="OnCloseClicked"
			        Background="#90CAF9"
			        Foreground="White"
			        Padding="24,10"
			        CornerRadius="4"
			        FontWeight="SemiBold"/>
		</Grid>

	</Grid>
</Window>
